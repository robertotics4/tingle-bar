{"ast":null,"code":"import _regeneratorRuntime from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,createContext,useEffect}from'react';import api from'../services/api';import GeralContext from'./geral';var AuthContext=createContext();export var AuthFuncionarioProvider=function AuthFuncionarioProvider(_ref){var children=_ref.children;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),funcionario=_useState2[0],setFuncionario=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),estabelecimento=_useState4[0],setEstabelecimento=_useState4[1];var _useContext=useContext(GeralContext),setTipoUsuario=_useContext.setTipoUsuario;useEffect(function(){function loadStoragedData(){var storagedFuncionario=localStorage.getItem('@TBAuth:funcionario');var storagedToken=localStorage.getItem('@TBAuth:token');var storagedEstabelecimento=localStorage.getItem('@TBAuth:estabelecimento');if(storagedFuncionario&&storagedToken&&storagedEstabelecimento){setFuncionario(JSON.parse(storagedFuncionario));}}loadStoragedData();},[]);function signIn(_x){return _signIn.apply(this,arguments);}function _signIn(){_signIn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(credentials){var payload,response,accessToken;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;payload={\"Telefone\":credentials.telefone,\"Senha\":credentials.senha};_context.next=4;return api.post('/loginfuncionario',payload);case 4:response=_context.sent;accessToken=response.data.accessToken;delete response.data.accessToken;setFuncionario(response.data);localStorage.setItem('@TBAuth:funcionario',JSON.stringify(response.data));localStorage.setItem('@TBAuth:token',accessToken);localStorage.setItem('@TBAuth:tipoUsuario','funcionario');return _context.abrupt(\"return\",response);case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);return _context.abrupt(\"return\",_context.t0.response);case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,14]]);}));return _signIn.apply(this,arguments);}function signOut(){localStorage.clear();setTipoUsuario(null);setFuncionario(null);}function setEstabelecimentoFuncionario(data){setEstabelecimento(data);localStorage.setItem('@TBAuth:estabelecimento',JSON.stringify(data));}return/*#__PURE__*/React.createElement(AuthContext.Provider,{value:{signedFuncionario:!!funcionario,funcionario:funcionario,signIn:signIn,signOut:signOut,estabelecimento:estabelecimento,setEstabelecimentoFuncionario:setEstabelecimentoFuncionario}},children);};export default AuthContext;","map":{"version":3,"sources":["/home/roberto/Ãrea de Trabalho/tingle-bar/src/contexts/auth-funcionario.jsx"],"names":["React","useState","useContext","createContext","useEffect","api","GeralContext","AuthContext","AuthFuncionarioProvider","children","funcionario","setFuncionario","estabelecimento","setEstabelecimento","setTipoUsuario","loadStoragedData","storagedFuncionario","localStorage","getItem","storagedToken","storagedEstabelecimento","JSON","parse","signIn","credentials","payload","telefone","senha","post","response","accessToken","data","setItem","stringify","signOut","clear","setEstabelecimentoFuncionario","signedFuncionario"],"mappings":"0XAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,UAA1B,CAAsCC,aAAtC,CAAqDC,SAArD,KAAsE,OAAtE,CAEA,MAAOC,CAAAA,GAAP,KAAgB,iBAAhB,CACA,MAAOC,CAAAA,YAAP,KAAyB,SAAzB,CAEA,GAAMC,CAAAA,WAAW,CAAGJ,aAAa,EAAjC,CAEA,MAAO,IAAMK,CAAAA,uBAAuB,CAAG,QAA1BA,CAAAA,uBAA0B,MAAkB,IAAfC,CAAAA,QAAe,MAAfA,QAAe,eACfR,QAAQ,CAAC,IAAD,CADO,wCAC9CS,WAD8C,eACjCC,cADiC,8BAEPV,QAAQ,CAAC,IAAD,CAFD,yCAE9CW,eAF8C,eAE7BC,kBAF6B,+BAG1BX,UAAU,CAACI,YAAD,CAHgB,CAG7CQ,cAH6C,aAG7CA,cAH6C,CAKrDV,SAAS,CAAC,UAAM,CACZ,QAASW,CAAAA,gBAAT,EAA4B,CACxB,GAAMC,CAAAA,mBAAmB,CAAGC,YAAY,CAACC,OAAb,CAAqB,qBAArB,CAA5B,CACA,GAAMC,CAAAA,aAAa,CAAGF,YAAY,CAACC,OAAb,CAAqB,eAArB,CAAtB,CACA,GAAME,CAAAA,uBAAuB,CAAGH,YAAY,CAACC,OAAb,CAAqB,yBAArB,CAAhC,CAEA,GAAIF,mBAAmB,EAAIG,aAAvB,EAAwCC,uBAA5C,CAAqE,CACjET,cAAc,CAACU,IAAI,CAACC,KAAL,CAAWN,mBAAX,CAAD,CAAd,CACH,CACJ,CAEDD,gBAAgB,GACnB,CAZQ,CAYN,EAZM,CAAT,CALqD,QAmBtCQ,CAAAA,MAnBsC,8HAmBrD,iBAAsBC,WAAtB,mKAEcC,OAFd,CAEwB,CACZ,WAAYD,WAAW,CAACE,QADZ,CAEZ,QAASF,WAAW,CAACG,KAFT,CAFxB,uBAO+BtB,CAAAA,GAAG,CAACuB,IAAJ,CAAS,mBAAT,CAA8BH,OAA9B,CAP/B,QAOcI,QAPd,eASgBC,WAThB,CASgCD,QAAQ,CAACE,IATzC,CASgBD,WAThB,CAUQ,MAAOD,CAAAA,QAAQ,CAACE,IAAT,CAAcD,WAArB,CAEAnB,cAAc,CAACkB,QAAQ,CAACE,IAAV,CAAd,CACAd,YAAY,CAACe,OAAb,CAAqB,qBAArB,CAA4CX,IAAI,CAACY,SAAL,CAAeJ,QAAQ,CAACE,IAAxB,CAA5C,EACAd,YAAY,CAACe,OAAb,CAAqB,eAArB,CAAsCF,WAAtC,EACAb,YAAY,CAACe,OAAb,CAAqB,qBAArB,CAA4C,aAA5C,EAfR,gCAiBeH,QAjBf,4FAmBe,YAAIA,QAnBnB,uEAnBqD,yCA0CrD,QAASK,CAAAA,OAAT,EAAmB,CACfjB,YAAY,CAACkB,KAAb,GACArB,cAAc,CAAC,IAAD,CAAd,CACAH,cAAc,CAAC,IAAD,CAAd,CACH,CAED,QAASyB,CAAAA,6BAAT,CAAuCL,IAAvC,CAA6C,CACzClB,kBAAkB,CAACkB,IAAD,CAAlB,CACAd,YAAY,CAACe,OAAb,CAAqB,yBAArB,CAAgDX,IAAI,CAACY,SAAL,CAAeF,IAAf,CAAhD,EACH,CAED,mBACI,oBAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAE,CAAEM,iBAAiB,CAAE,CAAC,CAAC3B,WAAvB,CAAoCA,WAAW,CAAXA,WAApC,CAAiDa,MAAM,CAANA,MAAjD,CAAyDW,OAAO,CAAPA,OAAzD,CAAkEtB,eAAe,CAAfA,eAAlE,CAAmFwB,6BAA6B,CAA7BA,6BAAnF,CAA7B,EACK3B,QADL,CADJ,CAKH,CA1DM,CA4DP,cAAeF,CAAAA,WAAf","sourcesContent":["import React, { useState, useContext, createContext, useEffect } from 'react';\n\nimport api from '../services/api';\nimport GeralContext from './geral';\n\nconst AuthContext = createContext();\n\nexport const AuthFuncionarioProvider = ({ children }) => {\n    const [funcionario, setFuncionario] = useState(null);\n    const [estabelecimento, setEstabelecimento] = useState(null);\n    const { setTipoUsuario } = useContext(GeralContext);\n\n    useEffect(() => {\n        function loadStoragedData() {\n            const storagedFuncionario = localStorage.getItem('@TBAuth:funcionario');\n            const storagedToken = localStorage.getItem('@TBAuth:token');\n            const storagedEstabelecimento = localStorage.getItem('@TBAuth:estabelecimento');\n\n            if (storagedFuncionario && storagedToken && storagedEstabelecimento) {\n                setFuncionario(JSON.parse(storagedFuncionario));\n            }\n        }\n\n        loadStoragedData();\n    }, []);\n\n    async function signIn(credentials) {\n        try {\n            const payload = {\n                \"Telefone\": credentials.telefone,\n                \"Senha\": credentials.senha\n            }\n\n            const response = await api.post('/loginfuncionario', payload);\n\n            const { accessToken } = response.data;\n            delete response.data.accessToken;\n\n            setFuncionario(response.data);\n            localStorage.setItem('@TBAuth:funcionario', JSON.stringify(response.data));\n            localStorage.setItem('@TBAuth:token', accessToken);\n            localStorage.setItem('@TBAuth:tipoUsuario', 'funcionario');\n\n            return response;\n        } catch (err) {\n            return err.response;\n        }\n    }\n\n    function signOut() {\n        localStorage.clear();\n        setTipoUsuario(null);\n        setFuncionario(null);\n    }\n\n    function setEstabelecimentoFuncionario(data) {\n        setEstabelecimento(data);\n        localStorage.setItem('@TBAuth:estabelecimento', JSON.stringify(data));\n    }\n\n    return (\n        <AuthContext.Provider value={{ signedFuncionario: !!funcionario, funcionario, signIn, signOut, estabelecimento, setEstabelecimentoFuncionario }}>\n            {children}\n        </AuthContext.Provider>\n    )\n};\n\nexport default AuthContext;"]},"metadata":{},"sourceType":"module"}