{"ast":null,"code":"import _regeneratorRuntime from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useForm}from\"react-hook-form\";import CurrencyInput from'react-currency-input';import Swal from'sweetalert2';import{Modal}from'react-bootstrap';import'../../../../components/Loading';import api from'../../../../services/api';import Loading from'../../../../components/Loading';function initialState(){return{titulo:'',descricao:'',valor:'',categoria:'',tempoEstimadoMin:0,tempoEstimadoMax:0,imagem:null,isCozinha:false,isCardapio:true};}export default function ModalCadCardapio(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),categorias=_useState2[0],setCategorias=_useState2[1];var _useState3=useState(initialState),_useState4=_slicedToArray(_useState3,2),valores=_useState4[0],setValores=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoadingVisible=_useState6[0],setLoadingVisible=_useState6[1];var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.errors;var onSubmit=function onSubmit(data){cadastrarItem(data);};useEffect(function(){getCategorias();},[]);var handleClose=function handleClose(){return props.setShowModal(false);};function getCategorias(){return _getCategorias.apply(this,arguments);}function _getCategorias(){_getCategorias=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return api.get('/categoria?idEstabelecimento='+props.idEstabelecimento);case 3:response=_context.sent;setCategorias(response.data);return _context.abrupt(\"return\",response.data);case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);return _context.abrupt(\"return\",_context.t0.response);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return _getCategorias.apply(this,arguments);}function cadastrarItem(_x){return _cadastrarItem.apply(this,arguments);}function _cadastrarItem(){_cadastrarItem=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dados){var data,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoadingVisible(true);data=new FormData();data.append(\"titulo\",dados.titulo);data.append(\"descricao\",dados.descricao);data.append(\"valor\",valores.valor);data.append(\"tempo_estimado_min\",dados.tempoEstimadoMin);data.append(\"tempo_estimado_max\",dados.tempoEstimadoMax);data.append(\"categoria\",dados.categoria);data.append(\"estabelecimento\",props.idEstabelecimento);data.append(\"iscozinha\",valores.isCozinha?1:0);data.append(\"iscardapio\",valores.isCardapio?1:0);data.append(\"files\",valores.imagem);_context2.prev=12;_context2.next=15;return api.post('/Cardapio',data,{headers:{'Content-Type':'multipart/form-data'}});case 15:response=_context2.sent;if(response.status===201||response.status===200){Swal.fire('Sucesso!','Item cadastrado com sucesso!','success');}_context2.next=22;break;case 19:_context2.prev=19;_context2.t0=_context2[\"catch\"](12);if(_context2.t0.response.status===401||_context2.t0.response.status===400){Swal.fire('Erro!','Falha ao cadastrar item','error');}case 22:_context2.prev=22;setLoadingVisible(false);props.atualizarItens();handleClose();return _context2.finish(22);case 27:case\"end\":return _context2.stop();}}},_callee2,null,[[12,19,22,27]]);}));return _cadastrarItem.apply(this,arguments);}function handleChange(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;setValores(_objectSpread({},valores,_defineProperty({},name,value)));}function handleChangeValor(event,maskedValue,floatValue){setValores(_objectSpread({},valores,{valor:floatValue}));}function handleChangeImagem(e){setValores(_objectSpread({},valores,{imagem:e.target.files[0]}));}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Modal,{show:props.showModal,onHide:handleClose,size:\"lg\",\"aria-labelledby\":\"contained-modal-title-vcenter\",centered:true},/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true},/*#__PURE__*/React.createElement(Modal.Title,null,\"Cadastro de item no Card\\xE1pio\")),/*#__PURE__*/React.createElement(\"form\",{autoComplete:\"off\",onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"tituloItemCardapio\"},\"T\\xEDtulo\"),/*#__PURE__*/React.createElement(\"input\",{name:\"titulo\",type:\"text\",className:errors.titulo?\"form-control is-invalid\":\"form-control\",id:\"tituloItemCardapio\",placeholder:\"T\\xEDtulo do item\",onChange:handleChange,ref:register({required:{value:\"Required\",message:\"O título é obrigatório\"}})}),/*#__PURE__*/React.createElement(\"span\",{className:\"error invalid-feedback\"},errors.titulo&&errors.titulo.message)),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"descricaoItemCardapio\"},\"Descri\\xE7\\xE3o\"),/*#__PURE__*/React.createElement(\"input\",{name:\"descricao\",type:\"text\",className:errors.descricao?\"form-control is-invalid\":\"form-control\",id:\"descricaoItemCardapio\",placeholder:\"Descri\\xE7\\xE3o do item\",onChange:handleChange,ref:register({required:{value:\"Required\",message:\"A descrição é obrigatória\"}})}),/*#__PURE__*/React.createElement(\"span\",{className:\"error invalid-feedback\"},errors.descricao&&errors.descricao.message)),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"valorItemCardapio\"},\"Valor\"),/*#__PURE__*/React.createElement(CurrencyInput,{name:\"valor\",type:\"text\",prefix:\"R$\",decimalSeparator:\",\",thousandSeparator:\".\",value:valores.valor,className:errors.valor?\"form-control is-invalid\":\"form-control\",id:\"valorItemCardapio\",onChangeEvent:handleChangeValor// ref={register({\n//     required: {\n//         value: \"Required\",\n//         message: \"O valor é obrigatório\"\n//     },\n// })}\n}),/*#__PURE__*/React.createElement(\"span\",{className:\"error invalid-feedback\"},errors.valorItemCardapio&&errors.valorItemCardapio.message)),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"categoriaItemCardapio\"},\"Categoria\"),/*#__PURE__*/React.createElement(\"select\",{name:\"categoria\",className:errors.categoria?\"form-control is-invalid\":\"form-control\",id:\"categoriaItemCardapio\",ref:register({required:{value:\"Required\",message:\"A categoria é obrigatória\"}})},/*#__PURE__*/React.createElement(\"option\",{value:\"\"},\"Selecione\"),categorias.map(function(item,index){return/*#__PURE__*/React.createElement(\"option\",{key:item.id,value:item.id},item.descricao);})),/*#__PURE__*/React.createElement(\"span\",{className:\"error invalid-feedback\"},errors.categoria&&errors.categoria.message)),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"tempoEstimadoMin\"},\"Tempo estimado m\\xEDnimo\"),/*#__PURE__*/React.createElement(\"input\",{name:\"tempoEstimadoMin\",type:\"number\",className:errors.tempoEstimadoMin?\"form-control is-invalid\":\"form-control\",id:\"tempoEstimadoMin\",placeholder:\"Tempo m\\xEDnimo estimado\",onChange:handleChange,ref:register({required:{value:\"Required\",message:\"O tempo estimado min é obrigatório\"}})}),/*#__PURE__*/React.createElement(\"span\",{className:\"error invalid-feedback\"},errors.tempoEstimadoMin&&errors.tempoEstimadoMin.message)),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"tempoEstimadoMax\"},\"Tempo estimado m\\xE1ximo\"),/*#__PURE__*/React.createElement(\"input\",{name:\"tempoEstimadoMax\",type:\"number\",className:errors.tempoEstimadoMax?\"form-control is-invalid\":\"form-control\",id:\"tempoEstimadoMax\",placeholder:\"Tempo m\\xEDnimo m\\xE1ximo\",onChange:handleChange,ref:register({required:{value:\"Required\",message:\"O tempo estimado max é obrigatório\"}})}),/*#__PURE__*/React.createElement(\"span\",{className:\"error invalid-feedback\"},errors.tempoEstimadoMax&&errors.tempoEstimadoMax.message)),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"imagemItemCardapio\"},\"Imagem do item\"),/*#__PURE__*/React.createElement(\"input\",{name:\"imagem\",type:\"file\",accept:\"image/png, image/jpeg\",className:errors.imagem?\"form-control-file is-invalid\":\"form-control-file\",id:\"imagemItemCardapio\",onChange:handleChangeImagem,ref:register({required:{value:\"Required\",message:\"A imagem é obrigatória\"}})}),/*#__PURE__*/React.createElement(\"span\",{className:\"error invalid-feedback\"},errors.imagem&&errors.imagem.message)),/*#__PURE__*/React.createElement(\"div\",{className:\"form-check\"},/*#__PURE__*/React.createElement(\"input\",{name:\"isCozinha\",type:\"checkbox\",className:\"form-check-input\",id:\"itemCozinhaCardapio\",onChange:handleChange}),/*#__PURE__*/React.createElement(\"label\",{className:\"form-check-label\",htmlFor:\"exampleCheck1\"},\"Item de cozinha ?\")),/*#__PURE__*/React.createElement(\"div\",{className:\"form-check\"},/*#__PURE__*/React.createElement(\"input\",{name:\"isCardapio\",type:\"checkbox\",className:\"form-check-input\",id:\"isCardapio\",onChange:handleChange,defaultChecked:true}),/*#__PURE__*/React.createElement(\"label\",{className:\"form-check-label\",htmlFor:\"exampleCheck1\"},\"Incluir no card\\xE1pio ?\")))),/*#__PURE__*/React.createElement(Modal.Footer,null,/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary\"},\"Cadastrar\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-secondary ml-3\",onClick:handleClose},\"Cancelar\")))),isLoadingVisible?/*#__PURE__*/React.createElement(Loading,null):null);}","map":{"version":3,"sources":["/home/roberto/Área de Trabalho/tingle-bar/src/pages/PainelEstabelecimento/pages/GerenciarCardapio/ModalCadCardapio.jsx"],"names":["React","useState","useEffect","useForm","CurrencyInput","Swal","Modal","api","Loading","initialState","titulo","descricao","valor","categoria","tempoEstimadoMin","tempoEstimadoMax","imagem","isCozinha","isCardapio","ModalCadCardapio","props","categorias","setCategorias","valores","setValores","isLoadingVisible","setLoadingVisible","register","handleSubmit","errors","onSubmit","data","cadastrarItem","getCategorias","handleClose","setShowModal","get","idEstabelecimento","response","dados","FormData","append","post","headers","status","fire","atualizarItens","handleChange","event","target","name","value","handleChangeValor","maskedValue","floatValue","handleChangeImagem","e","files","showModal","required","message","valorItemCardapio","map","item","index","id"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useForm } from \"react-hook-form\";\nimport CurrencyInput from 'react-currency-input';\nimport Swal from 'sweetalert2';\nimport { Modal } from 'react-bootstrap';\n\nimport '../../../../components/Loading';\n\nimport api from '../../../../services/api';\nimport Loading from '../../../../components/Loading';\n\nfunction initialState() {\n    return {\n        titulo: '',\n        descricao: '',\n        valor: '',\n        categoria: '',\n        tempoEstimadoMin: 0,\n        tempoEstimadoMax: 0,\n        imagem: null,\n        isCozinha: false,\n        isCardapio: true\n    };\n}\n\nexport default function ModalCadCardapio(props) {\n    const [categorias, setCategorias] = useState([]);\n    const [valores, setValores] = useState(initialState);\n    const [isLoadingVisible, setLoadingVisible] = useState(false);\n\n    const { register, handleSubmit, errors } = useForm();\n\n    const onSubmit = data => {\n        cadastrarItem(data);\n    };\n\n    useEffect(() => {\n        getCategorias();\n    }, []);\n\n    const handleClose = () => props.setShowModal(false);\n\n    async function getCategorias() {\n        try {\n            const response = await api.get('/categoria?idEstabelecimento=' + props.idEstabelecimento);\n            setCategorias(response.data);\n            return response.data;\n        } catch (err) {\n            return err.response;\n        }\n    }\n\n    async function cadastrarItem(dados) {\n        setLoadingVisible(true);\n\n        const data = new FormData();\n\n        data.append(\"titulo\", dados.titulo);\n        data.append(\"descricao\", dados.descricao);\n        data.append(\"valor\", valores.valor);\n        data.append(\"tempo_estimado_min\", dados.tempoEstimadoMin);\n        data.append(\"tempo_estimado_max\", dados.tempoEstimadoMax);\n        data.append(\"categoria\", dados.categoria);\n        data.append(\"estabelecimento\", props.idEstabelecimento);\n        data.append(\"iscozinha\", valores.isCozinha ? 1 : 0);\n        data.append(\"iscardapio\", valores.isCardapio ? 1 : 0);\n        data.append(\"files\", valores.imagem);\n\n        try {\n            const response = await api.post('/Cardapio', data, {\n                headers: {\n                    'Content-Type': 'multipart/form-data'\n                }\n            });\n\n            if (response.status === 201 || response.status === 200) {\n                Swal.fire('Sucesso!', 'Item cadastrado com sucesso!', 'success');\n            }\n        } catch (err) {\n            if (err.response.status === 401 || err.response.status === 400) {\n                Swal.fire('Erro!', 'Falha ao cadastrar item', 'error');\n            }\n        } finally {\n            setLoadingVisible(false);\n            props.atualizarItens();\n            handleClose();\n        }\n    }\n\n    function handleChange(event) {\n        const { name, value } = event.target;\n        setValores({ ...valores, [name]: value });\n    }\n\n    function handleChangeValor(event, maskedValue, floatValue) {\n        setValores({ ...valores, valor: floatValue });\n    }\n\n    function handleChangeImagem(e) {\n        setValores({ ...valores, imagem: e.target.files[0] });\n    }\n\n    return (\n        <>\n            <Modal\n                show={props.showModal}\n                onHide={handleClose}\n                size=\"lg\"\n                aria-labelledby=\"contained-modal-title-vcenter\"\n                centered\n            >\n                <Modal.Header closeButton>\n                    <Modal.Title>Cadastro de item no Cardápio</Modal.Title>\n                </Modal.Header>\n\n                <form autoComplete=\"off\" onSubmit={handleSubmit(onSubmit)}>\n                    <Modal.Body>\n                        <div className=\"card-body\">\n\n                            <div className=\"form-group\">\n                                <label htmlFor=\"tituloItemCardapio\">Título</label>\n                                <input\n                                    name=\"titulo\"\n                                    type=\"text\"\n                                    className={errors.titulo ? \"form-control is-invalid\" : \"form-control\"}\n                                    id=\"tituloItemCardapio\"\n                                    placeholder=\"Título do item\"\n                                    onChange={handleChange}\n                                    ref={register({\n                                        required: {\n                                            value: \"Required\",\n                                            message: \"O título é obrigatório\"\n                                        },\n                                    })}\n                                />\n                                <span className=\"error invalid-feedback\">{errors.titulo && errors.titulo.message}</span>\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label htmlFor=\"descricaoItemCardapio\">Descrição</label>\n                                <input\n                                    name=\"descricao\"\n                                    type=\"text\"\n                                    className={errors.descricao ? \"form-control is-invalid\" : \"form-control\"}\n                                    id=\"descricaoItemCardapio\"\n                                    placeholder=\"Descrição do item\"\n                                    onChange={handleChange}\n                                    ref={register({\n                                        required: {\n                                            value: \"Required\",\n                                            message: \"A descrição é obrigatória\"\n                                        },\n                                    })}\n                                />\n                                <span className=\"error invalid-feedback\">{errors.descricao && errors.descricao.message}</span>\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label htmlFor=\"valorItemCardapio\">Valor</label>\n                                <CurrencyInput\n                                    name=\"valor\"\n                                    type=\"text\"\n                                    prefix=\"R$\"\n                                    decimalSeparator=\",\"\n                                    thousandSeparator=\".\"\n                                    value={valores.valor}\n                                    className={errors.valor ? \"form-control is-invalid\" : \"form-control\"}\n                                    id=\"valorItemCardapio\"\n                                    onChangeEvent={handleChangeValor}\n                                // ref={register({\n                                //     required: {\n                                //         value: \"Required\",\n                                //         message: \"O valor é obrigatório\"\n                                //     },\n                                // })}\n                                />\n                                <span className=\"error invalid-feedback\">{errors.valorItemCardapio && errors.valorItemCardapio.message}</span>\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label htmlFor=\"categoriaItemCardapio\">Categoria</label>\n                                <select\n                                    name=\"categoria\"\n                                    className={errors.categoria ? \"form-control is-invalid\" : \"form-control\"}\n                                    id=\"categoriaItemCardapio\"\n                                    ref={register({\n                                        required: {\n                                            value: \"Required\",\n                                            message: \"A categoria é obrigatória\"\n                                        },\n                                    })}\n                                >\n                                    <option value=\"\">Selecione</option>\n                                    {categorias.map((item, index) => (\n                                        <option key={item.id} value={item.id}>{item.descricao}</option>\n                                    ))}\n                                </select>\n                                <span className=\"error invalid-feedback\">{errors.categoria && errors.categoria.message}</span>\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label htmlFor=\"tempoEstimadoMin\">Tempo estimado mínimo</label>\n                                <input\n                                    name=\"tempoEstimadoMin\"\n                                    type=\"number\"\n                                    className={errors.tempoEstimadoMin ? \"form-control is-invalid\" : \"form-control\"}\n                                    id=\"tempoEstimadoMin\"\n                                    placeholder=\"Tempo mínimo estimado\"\n                                    onChange={handleChange}\n                                    ref={register({\n                                        required: {\n                                            value: \"Required\",\n                                            message: \"O tempo estimado min é obrigatório\"\n                                        },\n                                    })}\n                                />\n                                <span className=\"error invalid-feedback\">{errors.tempoEstimadoMin && errors.tempoEstimadoMin.message}</span>\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label htmlFor=\"tempoEstimadoMax\">Tempo estimado máximo</label>\n                                <input\n                                    name=\"tempoEstimadoMax\"\n                                    type=\"number\"\n                                    className={errors.tempoEstimadoMax ? \"form-control is-invalid\" : \"form-control\"}\n                                    id=\"tempoEstimadoMax\"\n                                    placeholder=\"Tempo mínimo máximo\"\n                                    onChange={handleChange}\n                                    ref={register({\n                                        required: {\n                                            value: \"Required\",\n                                            message: \"O tempo estimado max é obrigatório\"\n                                        },\n                                    })}\n                                />\n                                <span className=\"error invalid-feedback\">{errors.tempoEstimadoMax && errors.tempoEstimadoMax.message}</span>\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label htmlFor=\"imagemItemCardapio\">Imagem do item</label>\n                                <input\n                                    name=\"imagem\"\n                                    type=\"file\"\n                                    accept=\"image/png, image/jpeg\"\n                                    className={errors.imagem ? \"form-control-file is-invalid\" : \"form-control-file\"}\n                                    id=\"imagemItemCardapio\"\n                                    onChange={handleChangeImagem}\n                                    ref={register({\n                                        required: {\n                                            value: \"Required\",\n                                            message: \"A imagem é obrigatória\"\n                                        },\n                                    })}\n                                />\n                                <span className=\"error invalid-feedback\">{errors.imagem && errors.imagem.message}</span>\n                            </div>\n\n                            <div className=\"form-check\">\n                                <input\n                                    name=\"isCozinha\"\n                                    type=\"checkbox\"\n                                    className=\"form-check-input\"\n                                    id=\"itemCozinhaCardapio\"\n                                    onChange={handleChange}\n                                />\n                                <label className=\"form-check-label\" htmlFor=\"exampleCheck1\">Item de cozinha ?</label>\n                            </div>\n\n                            <div className=\"form-check\">\n                                <input\n                                    name=\"isCardapio\"\n                                    type=\"checkbox\"\n                                    className=\"form-check-input\"\n                                    id=\"isCardapio\"\n                                    onChange={handleChange}\n                                    defaultChecked={true}\n                                />\n                                <label className=\"form-check-label\" htmlFor=\"exampleCheck1\">Incluir no cardápio ?</label>\n                            </div>\n                        </div>\n                    </Modal.Body>\n\n                    <Modal.Footer>\n                        <button type=\"submit\" className=\"btn btn-primary\">Cadastrar</button>\n                        <button type=\"button\" className=\"btn btn-secondary ml-3\" onClick={handleClose}>Cancelar</button>\n                    </Modal.Footer>\n                </form>\n            </Modal>\n\n            {isLoadingVisible ? <Loading /> : null}\n        </>\n    );\n}"]},"metadata":{},"sourceType":"module"}