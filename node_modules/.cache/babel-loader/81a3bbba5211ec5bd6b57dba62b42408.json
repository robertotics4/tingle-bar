{"ast":null,"code":"import _regeneratorRuntime from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/roberto/\\xC1rea de Trabalho/tingle-bar/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import{useForm}from\"react-hook-form\";import Swal from'sweetalert2';import{useHistory}from'react-router-dom';import InputMask from'react-input-mask';import Loading from'../../components/Loading';import AuthFuncionarioContext from'../../contexts/auth-funcionario';export default function LoginFuncionario(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),valores=_useState2[0],setValores=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoadingVisible=_useState4[0],setLoadingVisible=_useState4[1];var _useContext=useContext(AuthFuncionarioContext),signIn=_useContext.signIn;var _useContext2=useContext(AuthFuncionarioContext),setEstabelecimentoFuncionario=_useContext2.setEstabelecimentoFuncionario;var history=useHistory();var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.errors;useEffect(function(){},[isLoadingVisible]);var onSubmit=function onSubmit(data){setValores(data);loginFuncionario(data);};function handleChange(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;setValores(_objectSpread({},valores,_defineProperty({},name,value)));}function loginFuncionario(_x){return _loginFuncionario.apply(this,arguments);}function _loginFuncionario(){_loginFuncionario=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(credentials){var response,listaEstabelecimentos,_yield$Swal$fire,value;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoadingVisible(true);_context.next=3;return signIn(credentials);case 3:response=_context.sent;if(!(response.status===200||response.status===201)){_context.next=15;break;}listaEstabelecimentos=response.data.listaEstab;if(!(listaEstabelecimentos.length!==0)){_context.next=12;break;}_context.next=9;return Swal.fire({title:'Selecione o Estabelecimento',input:'select',inputOptions:listaEstabelecimentos.map(function(estabelecimento){return estabelecimento.nomeEstabelecimento;}),inputPlaceholder:'Selecione',inputValidator:function inputValidator(value){return new Promise(function(resolve){if(value){resolve();}else{resolve('Você precisa selecionar um estabelecimento');}});}});case 9:_yield$Swal$fire=_context.sent;value=_yield$Swal$fire.value;setEstabelecimentoFuncionario(listaEstabelecimentos[value]);case 12:setEstabelecimentoFuncionario(listaEstabelecimentos.pop());_context.next=16;break;case 15:if(response.status===401){Swal.fire({title:'Erro!',text:'Usuário ou senha inválidos',icon:'error',confirmButtonText:'Voltar'});}else{Swal.fire({title:'Erro!',text:'Falha ao efetuar login.',icon:'error',confirmButtonText:'Voltar'});}case 16:setLoadingVisible(false);case 17:case\"end\":return _context.stop();}}},_callee);}));return _loginFuncionario.apply(this,arguments);}return/*#__PURE__*/React.createElement(\"div\",{className:\"hold-transition login-page\"},/*#__PURE__*/React.createElement(\"div\",{className:\"login-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"login-logo\"},/*#__PURE__*/React.createElement(\"a\",{href:\"../../index2.html\"},/*#__PURE__*/React.createElement(\"b\",null,\"Tingle\"),\"Bar\")),/*#__PURE__*/React.createElement(\"div\",{className:\"card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-body login-card-body\"},/*#__PURE__*/React.createElement(\"p\",{className:\"login-box-msg\"},\"Login de Funcion\\xE1rio\"),/*#__PURE__*/React.createElement(\"form\",{autoComplete:\"off\",onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-3\"},/*#__PURE__*/React.createElement(InputMask,{type:\"text\",className:errors.cnpj?\"form-control is-invalid\":\"form-control\",placeholder:\"Telefone\",name:\"telefone\",onChange:handleChange,mask:\"(99) 99999-9999\",ref:register({required:{value:\"Required\",message:\"O Telefone é obrigatório\"}})}),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-append\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-text\"},/*#__PURE__*/React.createElement(\"span\",{className:\"fas fa-user\"}))),/*#__PURE__*/React.createElement(\"span\",{className:\"error invalid-feedback\"},errors.cnpj&&errors.cnpj.message)),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-3\"},/*#__PURE__*/React.createElement(\"input\",{type:\"password\",className:errors.senha?\"form-control is-invalid\":\"form-control\",placeholder:\"Senha\",name:\"senha\",onChange:handleChange,ref:register({required:{value:\"Required\",message:\"A senha é obrigatória\"},pattern:{//value: /(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{8,}$/, // Mínimo de oito caracteres, pelo menos uma letra e um número\nmessage:\"Mínimo de oito caracteres, com pelo menos uma letra e um número\"}})}),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-append\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-text\"},/*#__PURE__*/React.createElement(\"span\",{className:\"fas fa-lock\"}))),/*#__PURE__*/React.createElement(\"span\",{className:\"error invalid-feedback\"},errors.senha&&errors.senha.message)),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-3 col-md-12\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary btn-block\"},\"Acessar\")))),/*#__PURE__*/React.createElement(\"p\",{className:\"mb-1\"},/*#__PURE__*/React.createElement(\"a\",{href:\"forgot-password.html\"},\"Esqueci minha senha\")),/*#__PURE__*/React.createElement(\"p\",{className:\"mb-0\"},/*#__PURE__*/React.createElement(\"a\",{href:\"register.html\",className:\"text-center\"},\"Cadastrar um novo funcionario\"))))),isLoadingVisible?/*#__PURE__*/React.createElement(Loading,null):null);}","map":{"version":3,"sources":["/home/roberto/Área de Trabalho/tingle-bar/src/pages/LoginFuncionario/index.jsx"],"names":["React","useState","useEffect","useContext","useForm","Swal","useHistory","InputMask","Loading","AuthFuncionarioContext","LoginFuncionario","valores","setValores","isLoadingVisible","setLoadingVisible","signIn","setEstabelecimentoFuncionario","history","register","handleSubmit","errors","onSubmit","data","loginFuncionario","handleChange","event","target","name","value","credentials","response","status","listaEstabelecimentos","listaEstab","length","fire","title","input","inputOptions","map","estabelecimento","nomeEstabelecimento","inputPlaceholder","inputValidator","Promise","resolve","pop","text","icon","confirmButtonText","cnpj","required","message","senha","pattern"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\nimport { useForm } from \"react-hook-form\";\nimport Swal from 'sweetalert2';\nimport { useHistory } from 'react-router-dom';\nimport InputMask from 'react-input-mask';\n\nimport Loading from '../../components/Loading';\nimport AuthFuncionarioContext from '../../contexts/auth-funcionario';\n\nexport default function LoginFuncionario() {\n    const [valores, setValores] = useState({});\n    const [isLoadingVisible, setLoadingVisible] = useState(false);\n    const { signIn } = useContext(AuthFuncionarioContext);\n    const { setEstabelecimentoFuncionario } = useContext(AuthFuncionarioContext);\n\n    const history = useHistory();\n    const { register, handleSubmit, errors } = useForm();\n\n    useEffect(() => { }, [isLoadingVisible]);\n\n    const onSubmit = data => {\n        setValores(data);\n        loginFuncionario(data);\n    };\n\n    function handleChange(event) {\n        const { name, value } = event.target;\n        setValores({ ...valores, [name]: value });\n    }\n\n    async function loginFuncionario(credentials) {\n        setLoadingVisible(true);\n\n        const response = await signIn(credentials);\n\n        if (response.status === 200 || response.status === 201) {\n            const listaEstabelecimentos = response.data.listaEstab;\n\n            if (listaEstabelecimentos.length !== 0) {\n                const { value } = await Swal.fire({\n                    title: 'Selecione o Estabelecimento',\n                    input: 'select',\n                    inputOptions: listaEstabelecimentos.map(estabelecimento => estabelecimento.nomeEstabelecimento),\n                    inputPlaceholder: 'Selecione',\n                    inputValidator: value => {\n                        return new Promise((resolve) => {\n                            if (value) {\n                                resolve();\n                            } else {\n                                resolve('Você precisa selecionar um estabelecimento');\n                            }\n                        });\n                    }\n                });\n\n                setEstabelecimentoFuncionario(listaEstabelecimentos[value]);\n            }\n\n            setEstabelecimentoFuncionario(listaEstabelecimentos.pop());\n        } else if (response.status === 401) {\n            Swal.fire({\n                title: 'Erro!',\n                text: 'Usuário ou senha inválidos',\n                icon: 'error',\n                confirmButtonText: 'Voltar'\n            });\n        } else {\n            Swal.fire({\n                title: 'Erro!',\n                text: 'Falha ao efetuar login.',\n                icon: 'error',\n                confirmButtonText: 'Voltar'\n            });\n        }\n\n        setLoadingVisible(false);\n    }\n\n    return (\n        <div className=\"hold-transition login-page\">\n            <div className=\"login-box\">\n                <div className=\"login-logo\">\n                    <a href=\"../../index2.html\"><b>Tingle</b>Bar</a>\n                </div>\n                {/* /.login-logo */}\n                <div className=\"card\">\n                    <div className=\"card-body login-card-body\">\n                        <p className=\"login-box-msg\">Login de Funcionário</p>\n\n                        <form autoComplete=\"off\" onSubmit={handleSubmit(onSubmit)}>\n\n                            <div className=\"input-group mb-3\">\n                                <InputMask\n                                    type=\"text\"\n                                    className={errors.cnpj ? \"form-control is-invalid\" : \"form-control\"}\n                                    placeholder=\"Telefone\"\n                                    name=\"telefone\"\n                                    onChange={handleChange}\n                                    mask=\"(99) 99999-9999\"\n                                    ref={register({\n                                        required: {\n                                            value: \"Required\",\n                                            message: \"O Telefone é obrigatório\"\n                                        }\n                                    })}\n                                />\n                                <div className=\"input-group-append\">\n                                    <div className=\"input-group-text\">\n                                        <span className=\"fas fa-user\" />\n                                    </div>\n                                </div>\n                                <span className=\"error invalid-feedback\">{errors.cnpj && errors.cnpj.message}</span>\n                            </div>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    type=\"password\"\n                                    className={errors.senha ? \"form-control is-invalid\" : \"form-control\"}\n                                    placeholder=\"Senha\"\n                                    name=\"senha\"\n                                    onChange={handleChange}\n                                    ref={register({\n                                        required: {\n                                            value: \"Required\",\n                                            message: \"A senha é obrigatória\"\n                                        },\n                                        pattern: {\n                                            //value: /(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{8,}$/, // Mínimo de oito caracteres, pelo menos uma letra e um número\n                                            message: \"Mínimo de oito caracteres, com pelo menos uma letra e um número\"\n                                        }\n                                    })}\n                                />\n                                <div className=\"input-group-append\">\n                                    <div className=\"input-group-text\">\n                                        <span className=\"fas fa-lock\" />\n                                    </div>\n                                </div>\n                                <span className=\"error invalid-feedback\">{errors.senha && errors.senha.message}</span>\n                            </div>\n\n                            <div className=\"row\">\n                                <div className=\"input-group mb-3 col-md-12\">\n                                    <button type=\"submit\" className=\"btn btn-primary btn-block\">Acessar</button>\n                                </div>\n                                {/* /.col */}\n                            </div>\n                        </form>\n\n                        <p className=\"mb-1\">\n                            <a href=\"forgot-password.html\">Esqueci minha senha</a>\n                        </p>\n                        <p className=\"mb-0\">\n                            <a href=\"register.html\" className=\"text-center\">Cadastrar um novo funcionario</a>\n                        </p>\n                    </div>\n                    {/* /.login-card-body */}\n                </div>\n            </div>\n            {/* /.login-box */}\n\n            {isLoadingVisible ? <Loading /> : null}\n        </div>\n    );\n\n}"]},"metadata":{},"sourceType":"module"}